=pod

=head1 NAME

OSSL_CMP_exec_IR_ses,
OSSL_CMP_exec_CR_ses,
OSSL_CMP_exec_P10CR_ses,
OSSL_CMP_exec_KUR_ses,
OSSL_CMP_exec_RR_ses,
OSSL_CMP_exec_GENM_ses,
OSSL_CMP_certConf_cb
- functions implementing CMP client transactions

=head1 SYNOPSIS

 #include <openssl/cmp.h>

 X509 *OSSL_CMP_exec_IR_ses(OSSL_CMP_CTX *ctx);
 X509 *OSSL_CMP_exec_CR_ses(OSSL_CMP_CTX *ctx);
 X509 *OSSL_CMP_exec_P10CR_ses(OSSL_CMP_CTX *ctx);
 X509 *OSSL_CMP_exec_KUR_ses(OSSL_CMP_CTX *ctx);
 X509 *OSSL_CMP_exec_RR_ses(OSSL_CMP_CTX *ctx);
 STACK_OF(OSSL_CMP_ITAV) *OSSL_CMP_exec_GENM_ses(OSSL_CMP_CTX *ctx;
 int OSSL_CMP_certConf_cb(OSSL_CMP_CTX *ctx, X509 *cert, int fail_info,
                          const char **text);

=head1 DESCRIPTION

This is the API for doing CMP (Certificate Management Protocol)  client-server
message sequences using with OpenSSL.
The default conveying protocol is HTTP.

OSSL_CMP_exec_IR_ses() does the transaction which obtains an initial certificate
from the CA.
A populated OSSL_CMP_CTX structure has to be given as argument.

OSSL_CMP_exec_CR_ses() requests an additional certificate
from the CA.
A populated OSSL_CMP_CTX structure has to be given as argument.

OSSL_CMP_exec_P10CR_ses(OSSL_CMP_CTX *ctx) requests in PKCS#10 CSR form
a certificate from the CA.
A populated OSSL_CMP_CTX structure has to be given as argument.

OSSL_CMP_exec_KUR_ses() does the transaction which obtains an updated
certificate from the CA.
A populated OSSL_CMP_CTX structure has to be given
as argument.

OSSL_CMP_exec_RR_ses() requests the revocation of a certificate at the CA.

OSSL_CMP_exec_GENM_ses() sends a general message with any ITAVs specified in the
B<ctx>->genm_itavs, and returns the list of B<ITAV>s received in the GenRep.
This can be used, for instance, to poll for the CRL or CA Key Updates.

OSSL_CMP_certConf_cb() is a basic certificate confirmation callback validating
that the new certificate can be verified with the trusted/untrusted certificates
in B<ctx>.
As there is no requirement in RFC 4210 that the certificate can be
validated by the client, this callback is not set by default in the context.

=head1 NOTES

CMP is defined in RFC 4210 (and CRMF in RFC 4211).

=head1 RETURN VALUES

OSSL_CMP_exec_IR_ses(), OSSL_CMP_exec_CR_ses(),
OSSL_CMP_exec_P10CR_ses(), and OSSL_CMP_exec_KUR_ses() return a
pointer to the newly obtained X509 certificate on success, B<NULL> on error.
This pointer will be freed implicitly by OSSL_CMP_CTX_free() or
CSSL_CMP_CTX_reinit().

OSSL_CMP_exec_RR_ses() returns the
pointer to the revoked certificate on success, B<NULL> on error.
This pointer will be freed implicitly by OSSL_CMP_CTX_free().

OSSL_CMP_exec_GENM_ses() returns a
pointer to the received B<ITAV> sequence on success, B<NULL> on error.
This pointer must be freed by the caller.

OSSL_CMP_certConf_cb() returns B<fail_info> if it is not equal to B<0>,
else B<0> on successful validation,
or else a bit field with the B<OSSL_CMP_PKIFAILUREINFO_incorrectData> bit set.

=head1 EXAMPLES

See OSSL_CMP_CTX for examples on how to prepare the context for these
functions.

=head1 SEE ALSO

L<OSSL_CMP_CTX_new(3)>, L<OSSL_CMP_MSG_http_perform(3)>

=head1 HISTORY

The OpenSSL CMP support was added in OpenSSL 3.0.

=head1 COPYRIGHT

Copyright 2007-2019 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License"). You may not use
this file except in compliance with the License. You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
